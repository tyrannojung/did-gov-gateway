# DID Government Gateway

This is the gateway service for managing DIDs, VCs, and VPs on Hyperledger Fabric.

## Setup

### 1. Install Dependencies
```bash
npm install
```

### 2. Deploy Chaincode
```bash
# From test-network directory
./network.sh up createChannel -c mychannel -ca -s couchdb

# Deploy with simplified endorsement policy for testing
./network.sh deployCC -c mychannel -ccn anamdid \
  -ccp ../did-fabric-contract -ccl javascript -ccs 1 \
  -ccep "OR('Org1MSP.peer')"
```

### 3. Configure Environment
```bash
# Copy .env.example to .env and update Fabric paths
cp .env.example .env
# Edit .env to update FABRIC_* paths with your actual paths
```

### 4. Setup Issuer
```bash
# This will generate issuer keys and register issuer DID on chain
npm run setup
```

### 5. Start Server
```bash
npm start
# Server will run on port 8081
```

## API Endpoints

### DID Management
- `POST /dids/user` - Register user DID with public key
- `GET /dids/:did` - Get DID document from chain

### License Management  
- `POST /licenses` - Create license DID and issue VC

### VC Management
- `GET /vcs/:vcId` - Get specific VC from chain
- `GET /vcs/:vcId/verify` - Verify VC on chain

### VP Management
- `POST /vps/verify` - Verify VP with challenge

## Environment Variables

See `.env.example` for all required environment variables. The key variables include:
- `PORT` - Server port (default: 8081)
- `FABRIC_*` - Fabric connection credentials
- `ISSUER_ID` and `ISSUER_DID` - Auto-generated by npm run setup
- `CHAINCODE_NAME` - Chaincode name (anamdid)

## Security Notes

- The `src/storage/` directory contains private keys and is gitignored
- Never commit wallet files or private keys
- Always use HTTPS in production